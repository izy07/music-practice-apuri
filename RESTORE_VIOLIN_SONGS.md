# バイオリンの代表曲復元手順

## 📋 概要

以前設定していたバイオリンの代表曲を復元し、アプリで表示できるようにします。

---

## 🎻 復元される代表曲（全15曲）

1. **コウモリ序曲** - ヨハン・シュトラウス2世
2. **情熱大陸** - 葉加瀬太郎
3. **G線のアリア** - ヨハン・セバスチャン・バッハ
4. **チャルダッシュ** - ヴィットーリオ・モンティ
5. **ツィゴイネルワイゼン** - パブロ・デ・サラサーテ
6. **カプリース第24番** - ニコロ・パガニーニ
7. **四季「春」** - アントニオ・ヴィヴァルディ
8. **愛のあいさつ** - エドワード・エルガー
9. **ハバネラ** - ジョルジュ・ビゼー
10. **ユーモレスク** - アントニン・ドヴォルザーク
11. **メンデルスゾーンのバイオリン協奏曲 第1楽章** - フェリックス・メンデルスゾーン
12. **ブラームスのバイオリン協奏曲 第1楽章** - ヨハネス・ブラームス
13. **二つのバイオリンのための協奏曲** - ヨハン・セバスチャン・バッハ
14. **カノン** - パッヘルベル
15. **サマータイム** - ガーシュウィン

---

## 🚀 マイグレーション実行方法

### 方法1: Supabaseダッシュボードから実行（推奨）

1. **Supabaseダッシュボードにログイン**
   - https://supabase.com/dashboard
   - プロジェクトを選択

2. **SQL Editorを開く**
   - 左メニューから「SQL Editor」をクリック

3. **マイグレーションファイルを実行**
   - `supabase/migrations/20251203000000_restore_violin_representative_songs.sql` の内容をすべてコピー
   - SQL Editorに貼り付け
   - 「RUN」ボタンをクリック

4. **実行結果を確認**
   - 以下のメッセージが表示されれば成功：
     ```
     NOTICE: バイオリンの代表曲を復元しました（合計15曲）
     NOTICE: ========================================
     NOTICE: バイオリンの代表曲復元マイグレーション完了
     ```

### 方法2: Supabase CLIから実行

```bash
# プロジェクトディレクトリに移動
cd music-practice

# Supabaseにログイン（初回のみ）
supabase login

# マイグレーションを実行
supabase db push
```

---

## 📱 アプリでの表示確認

### 1. 代表曲画面へのアクセス方法

**方法A: InstrumentHeaderから**
1. アプリを起動
2. ヘッダーの楽器アイコンをタップ
3. 「代表曲を見る」ボタンをタップ

**方法B: 直接URLでアクセス**
- `/representative-songs?instrumentId=550e8400-e29b-41d4-a716-446655440003`

### 2. 表示内容の確認

代表曲画面では以下が表示されます：
- ✅ 楽器名（バイオリン / Violin）
- ✅ 代表曲一覧（15曲）
  - 曲名
  - 作曲者
  - 時代
  - YouTubeリンク（クリックで開く）
- ✅ 空の状態のフォールバック処理

---

## ✅ 実行後の確認

### データベースの確認

Supabaseダッシュボード → Database → Tables → `representative_songs` で以下を確認：

```sql
-- バイオリンの代表曲数を確認
SELECT COUNT(*) 
FROM representative_songs 
WHERE instrument_id = '550e8400-e29b-41d4-a716-446655440003';

-- バイオリンの代表曲一覧を確認
SELECT title, composer, display_order 
FROM representative_songs 
WHERE instrument_id = '550e8400-e29b-41d4-a716-446655440003'
ORDER BY display_order;
```

期待される結果: **15曲**が表示される

---

## 🔄 トラブルシューティング

### エラー: "representative_songsテーブルが存在しません"

**解決方法**:
1. `representative_songs`テーブルを作成するマイグレーションを先に実行
2. 以下のマイグレーションファイルを実行：
   - `20250120000002_create_representative_songs.sql`
   - または `20251121174558_ensure_representative_songs_table.sql`

### エラー: "バイオリンが存在しません"

**解決方法**:
- マイグレーション内で自動的にバイオリンデータが挿入されます
- それでもエラーが出る場合は、`instruments`テーブルにバイオリンのデータがあるか確認

### 代表曲が表示されない

**確認事項**:
1. マイグレーションが正常に実行されたか確認
2. `representative_songs`テーブルにデータが存在するか確認
3. アプリを再起動してデータを再読み込み
4. ブラウザのキャッシュをクリア

---

## 📝 マイグレーションファイルの場所

- **ファイルパス**: `supabase/migrations/20251203000000_restore_violin_representative_songs.sql`
- **実行日**: 2025-12-03
- **対象**: バイオリン（instrument_id: `550e8400-e29b-41d4-a716-446655440003`）

---

## 🎯 完了後の状態

マイグレーション実行後：
- ✅ バイオリンの代表曲15曲がデータベースに登録される
- ✅ アプリの代表曲画面で表示される
- ✅ YouTubeリンクから動画を開ける
- ✅ 楽器選択時に代表曲が確認できる

---

**作成日**: 2025-12-03  
**優先度**: 🟡 中（機能の復元）


