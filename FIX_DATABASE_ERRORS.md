# データベースエラー修正ガイド

## 問題の概要

メイン画面で以下の404エラーが発生していました：
- `events` テーブルが存在しない
- `goals` テーブルが存在しない
- `practice_sessions` テーブルが存在しない
- `recordings` テーブルが存在しない

## 解決方法

### 1. マイグレーションの実行

以下のコマンドでSupabaseデータベースにマイグレーションを適用してください：

```bash
cd music-practice
npx supabase db reset
```

または、新しいマイグレーションのみを適用する場合：

```bash
cd music-practice
npx supabase migration up
```

### 2. マイグレーションファイルの確認

統合マイグレーションファイルが作成されました：
- `supabase/migrations/20260130000000_ensure_all_core_tables_complete.sql`

このマイグレーションは以下のテーブルを確実に作成します：
- `events` - イベント管理
- `goals` - 目標設定
- `practice_sessions` - 練習セッション記録
- `recordings` - 録音データ

### 3. エラーハンドリングの改善

以下のファイルでエラーハンドリングを改善しました：
- `app/(tabs)/index.tsx` - テーブルが存在しない場合の適切な処理

エラーコード `PGRST205` と `PGRST116` を検出し、テーブルが存在しない場合はユーザーフレンドリーなメッセージを表示します。

## 実行後の確認

マイグレーション実行後、以下を確認してください：

1. Supabaseダッシュボードでテーブルが作成されていることを確認
2. アプリを再起動してエラーが解消されていることを確認
3. ブラウザのコンソールでエラーが表示されていないことを確認

## 注意事項

- マイグレーション実行前にデータベースのバックアップを推奨します
- 既存のデータがある場合は、マイグレーションが安全に実行されるよう設計されています（`IF NOT EXISTS` を使用）

## アクセシビリティ警告について

`aria-hidden` に関する警告は、React Native WebとExpo Routerの組み合わせで発生する既知の問題です。これは開発環境での警告であり、実際のアプリケーションの動作には影響しません。将来的にReact Native Webのアップデートで解決される可能性があります。

